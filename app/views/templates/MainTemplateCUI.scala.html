@*
 * Copyright 2021 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import config.AppConfig
@import uk.gov.hmrc.play.views.html.layouts
@import uk.gov.hmrc.webchat.client.WebChatClient

@this(
    govuk_wrapper: GovukWrapperCUI,
    sidebar: Sidebar,
    article: Article,
    appConfig: AppConfig,
    webChatClient: WebChatClient
)

@(title: String,
    navTitle: Option[String] = None,
    sidebarLinks: Option[Html] = None,
    contentHeader: Option[Html] = None,
    bodyClasses: Option[String] = None,
    mainClass: Option[String] = None)(mainContent: Html)(implicit request : Request[_], messages: Messages)

@serviceInfoContent = {}

@sidebarContent = {
    @if(sidebarLinks.isDefined) {
        @sidebar(sidebarLinks.get, Some("sidebar"))
    }
}

@wrapMainContent = {
    @mainContent
}

@scriptElem = {

<script>
window.isCUI = true;
</script>

@if(!appConfig.performanceTest){
<script>
    var chatListener = {
    onPageLanding: function(evt) {
        console.log("On Page Landing: data=", evt.data, "page=", evt.page, "reinitialized=", evt.reinitialized);
    },
    onRuleSatisfied: function(evt) {
        console.log("On Rule Satisfied:", evt);
    },
    onExposureQualified: function(evt) {
        console.log("On Exposure Qualified:", evt);
    },
    chatRequestQ: function(evt) {
        console.log("chatRequestQ:", evt);
    },
    onServiceInvitation: function(evt) {
        console.log("onServiceInvitation:", evt);
    },
    onServiceMissed: function(evt) {
        console.log("onServiceMissed:", evt);
    },
    onChatLaunched: function(evt) {
        console.log("Chat Launched: chatID=" +evt.chatID+
            ",customerID=" +evt.customerID + " Chat Type: " + evt.chatType + " Biz Rule Name: " + evt.bizRuleName + " Event Type: " + evt.evtType);
    },
    onChatClosed: function(evt){
        console.log("Chat Closed: chatID=" +evt.chatID+ ", chatType="+evt.chatType+ ", evtType=" +evt.evtType + " Biz Rule Name: " + evt.bizRuleName + ",customerID=" +evt.customerID);
    },
    onC2CStateChanged: function(evt) {
        console.log("C2C State Changed - rule= "+evt.bizRuleName+", oldstate: " + evt.oldState + ", newstate: "+evt.newState + ",customerID=" +evt.customerID);
    },
    onC2CDisplayed: function(evt) {
        console.log("C2C Displayed - rule= ", evt);
    },

    onC2CDisplayed: function(evt) {
        console.log("C2C Displayed: Business Rule Name: " + evt.bizRuleName + " Customer ID: " + evt.customerID );
    },
    onC2CClicked: function(evt) {
        console.log("C2C Clicked: Business Rule Name: " + evt.bizRuleName + " Customer ID: " + evt.customerID );
    },
    onChatEngagedEvent: function(evt) {
        console.log("Chat Engaged: chatID=" +evt.chatID+ ", chatType="+evt.chatType+ ", evtType=" +evt.evtType + " Biz Rule Name: " + evt.bizRuleName + ",customerID=" +evt.customerID);
    },
    onAnyEvent: function(evt) {
        console.log("Chat any event:", evt);
    }

};

var InqRegistry = {
    listeners: [chatListener]
};
</script>

        @{webChatClient.loadWebChatContainer("HMRC_Anchored_1")}
        @{webChatClient.loadRequiredElements()}
    }
}

@govuk_wrapper(appConfig = appConfig,
               title = title,
               navTitle = navTitle,
               mainClass = mainClass,
               bodyClasses = bodyClasses,
               sidebar = sidebarContent,
               contentHeader = contentHeader,
               mainContent = article(wrapMainContent),
               serviceInfoContent = serviceInfoContent,
               scriptElem = Some(scriptElem)
)
